<h3><%= t :dragnet_show_selection_header, :default=> "Dragnet investigation for performance bottlenecks and usage of anti-pattern"%></h3>

<script type="text/javascript">
    $(function () {
        $('#dragnet_selection_tree')
                // listen for event
                .on('changed.jstree', function (e, data) {
                    jQuery.ajax({url: 'Dragnet/refresh_selected_data?&entry_id='+data.selected});
                })
                // create the instance
                .jstree({
                    'core': {
                        "multiple" : false,
                        'data': {
                            'url': 'Dragnet/get_selection_list/',
                            'data' : function (node) {
                                return { 'id' : node.id };
                            }
                        }
                    }
                });
            }
    );
</script>


<%= my_ajax_form_tag url_for(:controller => :dragnet, :action => "exec_dragnet_sql", :update_area=>"show_selection_result_area")  do %>
  <table width="100%">
    <tr>
      <td>
        <div><%= t(:dragnet_show_selection_select_hint, :default=>"Select dragnet-SQL for execution") %></div>
        <div id="dragnet_selection_tree" style="height: 300px; overflow-y: scroll; padding: 5px; background-color: #ffffff;">

        </div>
      </td>


      <td>
        <table style="border: 0px; " width="100%">
          <tr><td id="show_selection_header_area"></td></tr>
          <tr><td id="show_selection_hint_area" style="background-color: white;"></td></tr>
          <tr><td><span id="show_selection_param_area"></span>
            <%= hidden_field_tag('dragnet_hidden_entry_id') %>
            <div class="float_left"><%= submit_tag(t(:dragnet_show_selection_do_sql_caption, :default=>"Do selection"), :disabled=>true, :id=>'dragnet_show_selection_do_selection', :name=>:commit_exec, :title => t(:dragnet_show_selection_do_sql_hint, :default=>"Execute selected report")) %></div>
            <div class="float_left"><%= submit_tag("Show SQL",  :disabled=>true,  :id=>'dragnet_show_selection_show_sql',           :name=>:commit_show, :title => t(:dragnet_show_selection_show_sql_hint, :default=>"show select SQL-statement")) %></div>
          </td></tr>
        </table>
      </td>
    </tr>
  </table>
<% end %>

<div id="show_selection_result_area">
</div>
