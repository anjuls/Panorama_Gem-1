
<%
   def conv_value(val)
     if val.nil?
       nil
     else
       fn(val/@sample_seconds.to_f, 2)
     end
   end

   column_options =
           [
                   {:caption=>"Timestamp",             :data=>proc{|rec| localeDateTime(rec.start_sample)},          :title=>"Start of considered time range", :plot_master_time=>true },
                   {:caption=>"CPU-Time",              :data=>proc{|rec| conv_value(rec.cpu_time_secs)},     :align=>:right,  :title=>"Number of database sessions really working on CPU usage. From Active_Session_History.TM_Delta_CPU_Time."},
                   {:caption=>"DB-Time",               :data=>proc{|rec| conv_value(rec.db_time_secs)},      :align=>:right,  :title=>"Number of database sessions spent their time spent in database calls (including CPU). From Active_Session_History.TM_Delta_DB_Time."},
                   {:caption=>"CPU-Wait",              :data=>proc{|rec| conv_value(rec.on_cpu_secs)},       :align=>:right,  :title=>"Number of database sessions spent their time waiting on CPU (may be less than CPU-Time if CPU is not fully available). From Active_Session_History.Session_State='ON CPU'."},
           ]
%>

<%=
    gen_slickgrid(@waits, column_options, {:width     => :auto,
                                           :caption   => "Number of Sessions on CPU by Active Session History from #{@time_selection_start} until #{@time_selection_end}#{ " Instance=#{@instance}" if @instance}",
                                           :max_height=>450
                                          },
    )
%>
